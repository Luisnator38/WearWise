<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargador de Imágenes</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .header {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .header h1 {
            font-size: 1.5rem;
            color: #333;
        }
        
        .content {
            padding: 20px;
        }
        
        .preview-container {
            width: 100%;
            height: 250px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .preview-container.has-image {
            border-color: #4a90e2;
        }
        
        .preview-placeholder {
            text-align: center;
            color: #888;
        }
        
        .preview-placeholder svg {
            width: 48px;
            height: 48px;
            margin-bottom: 10px;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .clear-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #ff4d4f;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
        }
        
        .file-name {
            font-size: 0.875rem;
            color: #666;
            margin-bottom: 15px;
            word-break: break-all;
        }
        
        .error-message {
            color: #ff4d4f;
            font-size: 0.875rem;
            margin-bottom: 15px;
        }
        
        .footer {
            display: flex;
            padding: 20px;
            border-top: 1px solid #eee;
            gap: 10px;
        }
        
        .btn {
            flex: 1;
            padding: 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            transition: background-color 0.2s;
        }
        
        .btn svg {
            margin-right: 8px;
        }
        
        .btn-outline {
            background-color: white;
            border: 1px solid #d9d9d9;
            color: #333;
        }
        
        .btn-outline:hover {
            background-color: #f5f5f5;
        }
        
        .btn-primary {
            background-color: #4a90e2;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #3a80d2;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Añadir Imagen</h1>
        </div>
        <div class="content">
            <!-- Contenedor de vista previa -->
            <div class="preview-container" id="previewContainer">
                <div class="preview-placeholder" id="previewPlaceholder">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                    </svg>
                    <p>Selecciona una imagen o toma una foto</p>
                </div>
                <img id="previewImage" class="preview-image hidden" alt="Vista previa">
                <button id="clearButton" class="clear-button hidden">✕</button>
            </div>
            
            <!-- Nombre del archivo -->
            <p id="fileName" class="file-name hidden"></p>
            
            <!-- Mensaje de error -->
            <p id="errorMessage" class="error-message hidden"></p>
            
            <!-- Inputs ocultos -->
            <input type="file" id="fileInput" class="hidden" accept=".jpg,.jpeg,.png,.gif,.bmp,.tiff,.tif,.webp,.heif,.heic,.raw,.cr2,.nef,.arw,.orf,.dng,.svg,.ai,.eps,.pdf,.ico,.psd,.xcf,.exr,.tga,.targa">
            <input type="file" id="cameraInput" class="hidden" accept="image/*" capture="environment">
        </div>
        <div class="footer">
            <button class="btn btn-outline" id="galleryButton">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                Galería
            </button>
            <button class="btn btn-primary" id="cameraButton">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                    <circle cx="12" cy="13" r="4"></circle>
                </svg>
                Cámara
            </button>
        </div>
    </div>

    <script>
        // Elementos del DOM
        const fileInput = document.getElementById('fileInput');
        const cameraInput = document.getElementById('cameraInput');
        const galleryButton = document.getElementById('galleryButton');
        const cameraButton = document.getElementById('cameraButton');
        const previewContainer = document.getElementById('previewContainer');
        const previewPlaceholder = document.getElementById('previewPlaceholder');
        const previewImage = document.getElementById('previewImage');
        const clearButton = document.getElementById('clearButton');
        const fileName = document.getElementById('fileName');
        const errorMessage = document.getElementById('errorMessage');

        // Formatos de imagen soportados
        const supportedFormats = [
            "image/jpeg", "image/jpg", "image/png", "image/gif", "image/bmp", 
            "image/tiff", "image/webp", "image/heif", "image/heic", 
            "image/svg+xml", "application/pdf", "image/vnd.adobe.photoshop",
            "image/x-icon", "image/x-xcf", "image/x-exr", "image/x-tga"
        ];

        // Función para verificar la extensión del archivo
        function checkFileExtension(filename) {
            const supportedExtensions = [
                '.jpg', '.jpeg', '.png', '.gif', '.bmp', '.tiff', '.tif', '.webp', 
                '.heif', '.heic', '.raw', '.cr2', '.nef', '.arw', '.orf', '.dng', 
                '.svg', '.ai', '.eps', '.pdf', '.ico', '.psd', '.xcf', '.exr', '.tga', '.targa'
            ];
            
            const lowerFilename = filename.toLowerCase();
            return supportedExtensions.some(ext => lowerFilename.endsWith(ext));
        }

        // Función para manejar el cambio de archivo
        function handleFileChange(e) {
            const file = e.target.files[0];
            
            if (!file) return;
            
            // Verificar si el formato es soportado
            if (!supportedFormats.includes(file.type) && !checkFileExtension(file.name)) {
                showError("Formato de imagen no soportado");
                return;
            }
            
            // Mostrar nombre del archivo
            fileName.textContent = `Archivo: ${file.name}`;
            fileName.classList.remove('hidden');
            
            // Limpiar error si existe
            errorMessage.classList.add('hidden');
            
            // Crear URL para la vista previa
            const imageUrl = URL.createObjectURL(file);
            
            // Mostrar la imagen
            previewImage.src = imageUrl;
            previewImage.classList.remove('hidden');
            previewPlaceholder.classList.add('hidden');
            previewContainer.classList.add('has-image');
            clearButton.classList.remove('hidden');
        }

        // Función para mostrar error
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.classList.remove('hidden');
        }

        // Función para limpiar la imagen
        function clearImage() {
            previewImage.classList.add('hidden');
            previewPlaceholder.classList.remove('hidden');
            previewContainer.classList.remove('has-image');
            clearButton.classList.add('hidden');
            fileName.classList.add('hidden');
            errorMessage.classList.add('hidden');
            
            // Limpiar los inputs
            fileInput.value = '';
            cameraInput.value = '';
            
            // Revocar URL de objeto para liberar memoria
            if (previewImage.src) {
                URL.revokeObjectURL(previewImage.src);
                previewImage.src = '';
            }
        }

        // Event Listeners
        fileInput.addEventListener('change', handleFileChange);
        cameraInput.addEventListener('change', handleFileChange);
        
        galleryButton.addEventListener('click', () => {
            fileInput.click();
        });
        
        cameraButton.addEventListener('click', () => {
            cameraInput.click();
        });
        
        clearButton.addEventListener('click', clearImage);
    </script>
</body>
</html>